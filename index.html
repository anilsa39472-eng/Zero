<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZenSheet Pro | Performance Edition</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --primary: #2ecc71;
            --bg: #121212;
            --surface: #1e1e1e;
            --text: #e0e0e0;
            --border: #333;
            --accent: #3498db;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* AI Command Bar */
        #ai-header { padding: 12px; background: var(--surface); border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
        #ai-input { flex: 1; background: #2a2a2a; border: 1px solid var(--border); border-radius: 20px; padding: 10px 15px; color: white; outline: none; font-size: 14px; }

        /* Master Ribbon (Scrollable) */
        #ribbon { display: flex; overflow-x: auto; background: var(--surface); border-bottom: 1px solid var(--border); padding: 5px 0; white-space: nowrap; -ms-overflow-style: none; scrollbar-width: none; }
        #ribbon::-webkit-scrollbar { display: none; }
        .menu-group { display: inline-flex; border-right: 1px solid var(--border); padding: 0 10px; flex-direction: column; align-items: center; }
        .menu-label { font-size: 10px; color: #888; text-transform: uppercase; margin-top: 4px; font-weight: bold; }
        .btn-container { display: flex; gap: 8px; }
        .action-btn { background: transparent; border: none; color: var(--text); display: flex; flex-direction: column; align-items: center; padding: 8px; border-radius: 8px; cursor: pointer; min-width: 60px; }
        .action-btn:active { background: #333; }
        .action-btn span { font-size: 11px; margin-top: 4px; }

        /* Grid Area */
        #grid-wrapper { flex: 1; position: relative; overflow: auto; background: #fff; }
        canvas { display: block; }

        /* Footer Stats */
        #footer { height: 35px; background: var(--surface); border-top: 1px solid var(--border); display: flex; align-items: center; padding: 0 15px; font-size: 12px; gap: 20px; color: var(--primary); }

        /* Mobile Input Overlay */
        #cell-editor { position: absolute; display: none; border: 2px solid var(--primary); background: white; color: black; outline: none; padding: 0 5px; font-size: 14px; z-index: 100; }
    </style>
</head>
<body>

    <div id="ai-header">
        <i data-lucide="sparkles" style="color: var(--primary)"></i>
        <input type="text" id="ai-input" placeholder="Talk to your data (e.g. 'Sum of Column B')...">
    </div>

    <div id="ribbon">
        <div class="menu-group">
            <div class="btn-container">
                <button class="action-btn" onclick="newSheet()"><i data-lucide="file-plus"></i><span>New</span></button>
                <button class="action-btn" onclick="saveData()"><i data-lucide="cloud-upload"></i><span>Save</span></button>
            </div>
            <div class="menu-label">File</div>
        </div>
        <div class="menu-group">
            <div class="btn-container">
                <button class="action-btn"><i data-lucide="undo"></i><span>Undo</span></button>
                <button class="action-btn"><i data-lucide="copy"></i><span>Copy</span></button>
            </div>
            <div class="menu-label">Edit</div>
        </div>
        <div class="menu-group">
            <div class="btn-container">
                <button class="action-btn"><i data-lucide="bar-chart-3"></i><span>Chart</span></button>
                <button class="action-btn"><i data-lucide="link"></i><span>Link</span></button>
            </div>
            <div class="menu-label">Insert</div>
        </div>
        <div class="menu-group">
            <div class="btn-container">
                <button class="action-btn"><i data-lucide="function-square"></i><span>AutoSum</span></button>
            </div>
            <div class="menu-label">Formulas</div>
        </div>
        <div class="menu-group">
            <div class="btn-container">
                <button class="action-btn"><i data-lucide="filter"></i><span>Filter</span></button>
            </div>
            <div class="menu-label">Data</div>
        </div>
    </div>

    <div id="grid-wrapper">
        <canvas id="main-canvas"></canvas>
        <input type="text" id="cell-editor">
    </div>

    <div id="footer">
        <span id="stat-sum">SUM: 0</span>
        <span id="stat-avg">AVG: 0</span>
        <span id="db-status" style="margin-left: auto; color: #666">Online</span>
    </div>

    <script>
        // High Performance Config
        const canvas = document.getElementById('main-canvas');
        const ctx = canvas.getContext('2d');
        const editor = document.getElementById('cell-editor');
        
        const COLS = 26;
        const ROWS = 100000;
        const CELL_W = 100;
        const CELL_H = 35;
        
        let data = {}; // IndexedDB data store
        let scrollX = 0;
        let scrollY = 0;

        function init() {
            lucide.createIcons();
            resize();
            render();
            setupDB();
        }

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = document.getElementById('grid-wrapper').offsetHeight;
            render();
        }

        function render() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = "14px Arial";
            
            // Draw Grid Lines
            ctx.strokeStyle = "#e0e0e0";
            ctx.beginPath();

            for (let i = 0; i <= canvas.width / CELL_W + 1; i++) {
                let x = i * CELL_W - (scrollX % CELL_W);
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
            }
            for (let j = 0; j <= canvas.height / CELL_H + 1; j++) {
                let y = j * CELL_H - (scrollY % CELL_H);
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
            }
            ctx.stroke();

            // Draw Data
            ctx.fillStyle = "#000";
            let startCol = Math.floor(scrollX / CELL_W);
            let startRow = Math.floor(scrollY / CELL_H);

            for(let r = startRow; r < startRow + 30; r++) {
                for(let c = startCol; c < startCol + 10; c++) {
                    let key = `${r}:${c}`;
                    if(data[key]) {
                        ctx.fillText(data[key], (c * CELL_W - scrollX) + 5, (r * CELL_H - scrollY) + 23);
                    }
                }
            }
        }

        // Database Setup (IndexedDB)
        function setupDB() {
            const request = indexedDB.open("ZenSheetDB", 1);
            request.onupgradeneeded = (e) => {
                e.target.result.createObjectStore("sheets", { keyPath: "id" });
            };
            request.onsuccess = (e) => {
                document.getElementById('db-status').innerText = "Storage: Ready";
            };
        }

        function saveData() {
            // Simple logic to show save
            document.getElementById('db-status').innerText = "Saving...";
            setTimeout(() => {
                document.getElementById('db-status').innerText = "Saved Locally";
            }, 800);
        }

        function newSheet() {
            if(confirm("Clear all data?")) {
                data = {};
                render();
            }
        }

        // Basic Touch/Click Handling
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left + scrollX;
            const y = e.clientY - rect.top + scrollY;
            
            const col = Math.floor(x / CELL_W);
            const row = Math.floor(y / CELL_H);
            
            showEditor(row, col, e.clientX, e.clientY);
        });

        function showEditor(r, c, x, y) {
            editor.style.display = 'block';
            editor.style.left = (x - (x % CELL_W)) + 'px';
            editor.style.top = (y - (y % CELL_H)) + 'px';
            editor.style.width = CELL_W + 'px';
            editor.style.height = CELL_H + 'px';
            editor.value = data[`${r}:${c}`] || "";
            editor.focus();

            editor.onblur = () => {
                data[`${r}:${c}`] = editor.value;
                editor.style.display = 'none';
                render();
            };
        }

        window.addEventListener('resize', resize);
        init();
    </script>
</body>
          </html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZenSheet Pro | Desktop Power on Mobile</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --primary: #2ecc71; --bg: #0f0f0f; --surface: #1e1e1e;
            --text: #ffffff; --border: #333; --accent: #3498db;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        body { margin: 0; font-family: 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* AI TOP BAR */
        #ai-header { padding: 10px; background: var(--surface); border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
        #ai-input { flex: 1; background: #2a2a2a; border: 1px solid var(--border); border-radius: 8px; padding: 12px; color: white; font-size: 14px; }

        /* MAIN NAVIGATION (TABS) */
        #menu-tabs { display: flex; background: #181818; border-bottom: 1px solid var(--border); overflow-x: auto; scrollbar-width: none; }
        .tab { padding: 12px 20px; font-size: 12px; font-weight: bold; color: #888; cursor: pointer; text-transform: uppercase; border-bottom: 2px solid transparent; }
        .tab.active { color: var(--primary); border-bottom: 2px solid var(--primary); background: #222; }

        /* RIBBON BUTTONS AREA */
        #ribbon-content { background: var(--surface); padding: 10px; border-bottom: 1px solid var(--border); display: none; overflow-x: auto; white-space: nowrap; gap: 15px; }
        #ribbon-content.active { display: flex; }
        
        .action-btn { display: inline-flex; flex-direction: column; align-items: center; gap: 5px; background: none; border: none; color: var(--text); cursor: pointer; min-width: 65px; }
        .action-btn i { width: 20px; height: 20px; color: var(--primary); }
        .action-btn span { font-size: 10px; }

        /* GRID AREA */
        #grid-wrapper { flex: 1; position: relative; overflow: auto; background: #fff; }
        canvas { display: block; }
        #cell-editor { position: absolute; display: none; border: 2px solid var(--primary); background: white; color: black; z-index: 100; font-size: 16px; padding: 5px; }

        /* FOOTER */
        #footer { height: 35px; background: var(--surface); border-top: 1px solid var(--border); display: flex; align-items: center; padding: 0 15px; font-size: 11px; justify-content: space-between; }
    </style>
</head>
<body>

    <div id="ai-header">
        <i data-lucide="bot"></i>
        <input type="text" id="ai-input" placeholder="E.g. 'Apply Filter to Column A' or 'Calculate Margin'...">
    </div>

    <div id="menu-tabs">
        <div class="tab active" onclick="showMenu('file')">File</div>
        <div class="tab" onclick="showMenu('edit')">Edit</div>
        <div class="tab" onclick="showMenu('insert')">Insert</div>
        <div class="tab" onclick="showMenu('formula')">Formula</div>
        <div class="tab" onclick="showMenu('data')">Data</div>
        <div class="tab" onclick="showMenu('view')">View</div>
    </div>

    <div id="ribbon-content" class="active">
        <div id="menu-file" class="menu-set">
            <button class="action-btn" onclick="alert('New Sheet Created')"><i data-lucide="file-plus"></i><span>New</span></button>
            <button class="action-btn"><i data-lucide="folder-open"></i><span>Open</span></button>
            <button class="action-btn" onclick="saveToCloud()"><i data-lucide="cloud-save"></i><span>Save Cloud</span></button>
            <button class="action-btn"><i data-lucide="file-text"></i><span>Export PDF</span></button>
            <button class="action-btn"><i data-lucide="share-2"></i><span>Share</span></button>
        </div>
    </div>

    <div id="grid-wrapper">
        <canvas id="main-canvas"></canvas>
        <input type="text" id="cell-editor">
    </div>

    <div id="footer">
        <div><span style="color:var(--primary)">MODE:</span> READY</div>
        <div id="selection-stats">SUM: 0 | AVG: 0 | COUNT: 0</div>
    </div>

    <script>
        // Menu Data (Sub-buttons)
        const menuData = {
            file: [
                {icon: 'file-plus', label: 'New'}, {icon: 'folder-open', label: 'Open'}, 
                {icon: 'save', label: 'Save'}, {icon: 'file-text', label: 'PDF'}, {icon: 'share-2', label: 'Share'}
            ],
            edit: [
                {icon: 'undo-2', label: 'Undo'}, {icon: 'redo-2', label: 'Redo'}, 
                {icon: 'copy', label: 'Copy'}, {icon: 'clipboard-paste', label: 'Paste Spec'}, {icon: 'search', label: 'Find'}
            ],
            insert: [
                {icon: 'bar-chart-big', label: 'Chart'}, {icon: 'image', label: 'Image'}, 
                {icon: 'check-square', label: 'Checkbox'}, {icon: 'link', label: 'Link'}
            ],
            formula: [
                {icon: 'sigma', label: 'AutoSum'}, {icon: 'calculator', label: 'Financial'},
        
          
